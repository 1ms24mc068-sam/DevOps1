#Install Hashicorp gpg 
#Install Vagrant

vagrant init
nano Vagrantfile
Vagrant.configure("2") do |config|
  config.vm.box = "ubuntu/jammy64"

  config.vm.define "manager" do |manager|
    manager.vm.hostname = "manager"
    manager.vm.network "private_network", ip: "192.168.56.10"

    manager.vm.provider "virtualbox" do |vb|
      vb.memory = 2048
      vb.cpus = 2
    end
  end

  config.vm.define "worker" do |worker|
    worker.vm.hostname = "worker"
    worker.vm.network "private_network", ip: "192.168.56.11"

    worker.vm.provider "virtualbox" do |vb|
      vb.memory = 1024
      vb.cpus = 1
    end
  end
end
vagrant up

#lsmod | grep kvm
#sudo modprobe -r kvm (all)

#----------------------#
vagrant ssh manager
#Manager

sudo apt update -y
sudo apt install docker.io -y
sudo usermod -aG docker $USER
logout


docker swarm init --advertise-addr 192.168.56.10

#add worker & move to next steps

docker service create --name devops --replicas 3 -p 7070:7070 chethan2310/devops1:latest
docker service ps devops



#------------------------------#
#worker
vagrant ssh worker

sudo apt update -y
sudo apt install docker.io
sudo usermod -aG docker $USER
logout

#paste the swarm ID from manager
